# Ring 2023年 规划表

2022年下半年因为面试的原因，没有尽力去全力以赴的完善Ring，在此定义一个2023年的todo list。

## 年总规划

1. 通读 diksam_v0.4 https://github.com/GeneralSandman/diksam_v0.4
2. 使用 栈式虚拟机完善 全部功能
   1. 面向对象
   2. 闭包
   3. 生成字节码 到二进制文件 解析字节码
   4. 原文件可以分成包的形式
   5. 数组  
   6. 实现可变参数
   7. 实现反射 获取变量的类型 参考 go
   8. 优化字符串
   9. 优化内置 native函数  优化成库的形势
   10. 完善内置 printf 函数  很重要  可变参数 format
   11. 类型的强制转换 与 隐式转换
   12. 调试器 交互式编程
3. 完善语义分析 报错机制
4. 通读 Lua 5.x版本
   1. 力求完全掌握设计逻辑、包括协程、table
   2. 重新读那本 用Go语言实现Lua虚拟机
5. 将 栈式虚拟机 转为 寄存式虚拟机


将工作细化为以下几类工作：
- 调研：
- 理解：深度理解某项功能
- 设计：需求分析、规划，设计语法，设计功能，设计某项功能
- 实现：代码实现
- 测试：完善测试用例
- 重构：

更新时间：2023-04-13

[TOC]

-----------------------------


## 三. 2023-04-17～2023-04-21 周规划

### 周规划
1. 关于源代码切分
- 实现：package import 
- 实现：分package编译 生成字节码 链接

包的名称 不能 和类变量的名称一样，不然会有逻辑问题


### 2023-04-17
- 实现：源代码的切分编译 ✅
- 实现：编译器从C语言全部转为C++

### 2023-04-18
- 实现：源代码的切分编译、打包
- 实现：PacageUnit等 static变量的优化 
- 实现：导入使用 package
- 实现：定义package
- 重构：源代码没有变量编译错误 bug  ✅
- 重构：源代码import为空时编译错误 bug  ✅
- 重构：创建AST时，将 class_definition_list 和 function_list 转为 CPP-vector，更好的管理内存 ✅

### 2023-04-19 
- 实现：class method使用self关键字
- 实现：class method参数和返回值
- 实现：class 构造method
- 测试：完善 class 的相关测试


### 2023-04-20
- 实现：去除编译warn告警，提高编译速度
- 实现：实现比较好用printf函数

### 2023-04-21
- 设计：设计可变参数
- 实现：function method 返回值的严格检验 与 返回值处理

-----------------------------


## 二. 2023-04-10～2023-04-14 周规划


### 周规划

1. 实现面向对象的部分逻辑
- 实现：面向对象 field
- 实现：面向对象 method
- 实现：属性@public @private @constructor

2. 关于字节码二进制
- 实现：源代码与字节码的对应关系 更好的debug
- 理解：Lua字节码的定义，如果生成字节码，如何解析字节码


3. 关于源代码切分
- 实现：package import 
- 实现：分package编译 生成字节码 链接

4. 一些想到的问题
- 实现：属性 @format 应用到某个类的成员函数 定义重载打印对象数据结构的
- 虚拟机：当时设计的不足，不如预先分配一个比较大的空间 不能获取局部变量的数量
- 调研：调研现在主流的调试器


### 2023-04-10
- 实现：外部访问成员变量 ✅

### 2023-04-11
- 实现：通过对象访问成员变量：如job_0.Running = false; 如 println_bool(job_0.Running) ✅
- 设计：self 不设计成系统关键字，也就是不再语法分析的时候，不把他当作是一个token ✅
- 实现：通过对象调用成员函数method，只是简单实现了，见 008-class/class-001.ring ✅
- 实现：在method中访问field，涉及到self关键字
- 实现：Class 定义里边重新进行编写   field 一个list  method 一个list
- 实现：构造method
- 实现：实现@public @private

### 2023-04-12
- 理解：Diksam 在生成字节码的时候 同时记录与源代码之间的关系 LineNumber✅
- 实现：Ring实现记录字节码与源代码的映射关系✅
- 重构：简单重构一下代码✅
- 实现：main函数 @main

### 2023-04-13
- 理解：Diksam 是如何实现源代码切分的，也就是require ✅
- 设计：Ring 多源代码输入的编译逻辑 ✅
- 实现：Ring 的package定义 和 import 导包 ✅

### 2023-04-14
- 设计：Ring 多源代码输入的编译逻辑
  - 参考 GO env
- 调研：调试器

----------------------------------
## 一. 2023-04-03～2023-04-07 周规划

实现面向对象
- 理解：diksam 面向对象、源代码切分、面向对象内存分配
- 设计：成员变量的场景  成员方法放在下一期
- 设计：面向对象的语法
- 实现：面向对象的语法
- 设计：虚拟机支持 面向对象的 内存分配
- 实现：虚拟机支持 面向对象的 内存分配
- 测试：面向对象的测试用例
- 设计：字节码二进制文件的生成、解析   好好参考一下 Lua
